<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Deep Learning Notes - 9&nbsp; Tensor operation exercises</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Tensor operation exercises</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Deep Learning Notes</a> 
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">What is this?</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../artificial-neuron/artificial-neuron.html" class="sidebar-item-text sidebar-link">The Artificial Neuron</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../artificial-neuron/mcculloch-pitts-neuron.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">The McCulloch-Pitts Neuron</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../artificial-neuron/perceptron.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Perceptron</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../artificial-neuron/sigmoid-neuron.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The sigmoid neuron</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../artificial-neuron/modern-artificial-neuron.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The modern artificial neuron</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../machine-learning/machine-learning.html" class="sidebar-item-text sidebar-link">Machine Learning</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../machine-learning/machine-learning-setup.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">The machine learning setup</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../mathematics/mathematics.html" class="sidebar-item-text sidebar-link">Mathematics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mathematics/boolean-logic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Boolean Logic</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../mathematics/prerequisite-topology.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Prerequisite Topology</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../pytorch-experiments/pytorch-experiments.html" class="sidebar-item-text sidebar-link">Pytorch Experiments</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pytorch-experiments/indexing.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">indexing.html</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pytorch-experiments/basic_tensor_one.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Tensor operation exercises</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#probably-ndim-gives-the-number-of-dimensions-and-shape-gives-us-the-dimensions-of-the-tensoror-matrix-in-the-form-of-nxmx...." id="toc-probably-ndim-gives-the-number-of-dimensions-and-shape-gives-us-the-dimensions-of-the-tensoror-matrix-in-the-form-of-nxmx...." class="nav-link active" data-scroll-target="#probably-ndim-gives-the-number-of-dimensions-and-shape-gives-us-the-dimensions-of-the-tensoror-matrix-in-the-form-of-nxmx...."><span class="toc-section-number">9.1</span>  Probably, ndim gives the number of dimensions and shape gives us the dimensions of the tensor(or matrix) in the form of <span class="math inline">\(n\)</span>x<span class="math inline">\(m\)</span>x<span class="math inline">\(...\)</span>.</a></li>
  <li><a href="#why-are-there-discrepensies-with-the-precision-digit-after-the-decimal-point" id="toc-why-are-there-discrepensies-with-the-precision-digit-after-the-decimal-point" class="nav-link" data-scroll-target="#why-are-there-discrepensies-with-the-precision-digit-after-the-decimal-point"><span class="toc-section-number">10</span>  Why are there discrepensies with the precision digit after the decimal point?</a>
  <ul class="collapse">
  <li><a href="#tensor-operations" id="toc-tensor-operations" class="nav-link" data-scroll-target="#tensor-operations"><span class="toc-section-number">10.0.1</span>  Tensor Operations</a></li>
  <li><a href="#matrix-mult" id="toc-matrix-mult" class="nav-link" data-scroll-target="#matrix-mult"><span class="toc-section-number">10.0.2</span>  Matrix Mult</a></li>
  <li><a href="#agregation" id="toc-agregation" class="nav-link" data-scroll-target="#agregation"><span class="toc-section-number">10.0.3</span>  Agregation</a></li>
  <li><a href="#changing-datatype-of-a-tensor" id="toc-changing-datatype-of-a-tensor" class="nav-link" data-scroll-target="#changing-datatype-of-a-tensor"><span class="toc-section-number">10.0.4</span>  Changing Datatype of a tensor</a></li>
  <li><a href="#reshaping-stacking-squeezing-unsqueezing" id="toc-reshaping-stacking-squeezing-unsqueezing" class="nav-link" data-scroll-target="#reshaping-stacking-squeezing-unsqueezing"><span class="toc-section-number">10.0.5</span>  Reshaping, Stacking, Squeezing, Unsqueezing</a></li>
  <li><a href="#indexing" id="toc-indexing" class="nav-link" data-scroll-target="#indexing"><span class="toc-section-number">10.0.6</span>  Indexing</a></li>
  <li><a href="#the-data-explorers-motto-visualize-visualize-visualize" id="toc-the-data-explorers-motto-visualize-visualize-visualize" class="nav-link" data-scroll-target="#the-data-explorers-motto-visualize-visualize-visualize"><span class="toc-section-number">10.1</span>  The data explorerâ€™s motto : <strong>VISUALIZE, VISUALIZE, VISUALIZE</strong></a>
  <ul class="collapse">
  <li><a href="#pytorch-and-numpy" id="toc-pytorch-and-numpy" class="nav-link" data-scroll-target="#pytorch-and-numpy"><span class="toc-section-number">10.1.1</span>  PyTorch and NumPy</a></li>
  <li><a href="#reproducibility" id="toc-reproducibility" class="nav-link" data-scroll-target="#reproducibility"><span class="toc-section-number">10.1.2</span>  Reproducibility</a></li>
  </ul></li>
  <li><a href="#gpu" id="toc-gpu" class="nav-link" data-scroll-target="#gpu"><span class="toc-section-number">10.2</span>  GPU</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Tensor operation exercises</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell" data-tags="[]">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>scalar<span class="op">=</span>torch.tensor(<span class="dv">5</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>scalar</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>tensor(5)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>scalar.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>scalar.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>torch.Size([])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#To convert the tensor into a python integer (Only works with scalars(one element tesors))</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>scalar.item()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vectors are one dimensional tensors but can contain multiple numbers</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Vector</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>vector<span class="op">=</span>torch.tensor([<span class="dv">64</span>,<span class="dv">53</span>])</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>vector</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>tensor([64, 53])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>vector.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Shape of a vector tells us how to elemenst inside a vecotr are arranged</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>vector.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>torch.Size([2])</code></pre>
</div>
</div>
<p>It gives two because you put two numbers into the vector.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrices are vectors with TWO dimensions.</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>MATRIX<span class="op">=</span>torch.tensor([[<span class="dv">73</span>,<span class="dv">75732</span>],[<span class="dv">47</span>,<span class="dv">228</span>]])</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>MATRIX</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>tensor([[   73, 75732],
        [   47,   228]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>MATRIX.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>MATRIX.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>torch.Size([2, 2])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>ex0<span class="op">=</span>torch.tensor([<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">5</span>])</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>ex0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>tensor([1, 3, 5, 2, 5])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ex0.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>ex0.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>torch.Size([5])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>ex<span class="op">=</span>torch.tensor([[<span class="dv">2</span>,<span class="dv">4</span>],</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                 [<span class="dv">3</span>,<span class="dv">5</span>],</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                 [<span class="dv">7</span>,<span class="dv">1</span>]])</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>ex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>tensor([[2, 4],
        [3, 5],
        [7, 1]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>ex.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>ex.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>torch.Size([3, 2])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>ex2<span class="op">=</span>torch.tensor([[<span class="dv">2</span>,<span class="dv">8</span>],[<span class="dv">4</span>,<span class="dv">1</span>],[<span class="dv">75</span>,<span class="dv">49</span>],[<span class="dv">719</span>,<span class="dv">38</span>]])</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>ex2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>tensor([[  2,   8],
        [  4,   1],
        [ 75,  49],
        [719,  38]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>ex2.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>ex2.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>torch.Size([4, 2])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>ex3<span class="op">=</span>torch.tensor([[<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">2</span>],[<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">48</span>,<span class="dv">6</span>,<span class="dv">6</span>],[<span class="dv">29</span>,<span class="dv">653</span>,<span class="dv">5</span>,<span class="dv">32</span>,<span class="dv">6</span>]])</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>ex3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>tensor([[  3,   5,   1,   5,   2],
        [  4,   1,  48,   6,   6],
        [ 29, 653,   5,  32,   6]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>ex3.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>ex3.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>torch.Size([3, 5])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>ex4<span class="op">=</span>torch.rand(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>ex4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>tensor([[[0.6929, 0.7619, 0.8812, 0.1728, 0.7774],
         [0.1881, 0.8344, 0.2487, 0.1713, 0.0635],
         [0.8207, 0.0427, 0.4943, 0.6729, 0.1494],
         [0.9979, 0.5296, 0.1641, 0.2162, 0.8707]],

        [[0.9711, 0.8039, 0.5501, 0.8385, 0.4529],
         [0.8605, 0.9396, 0.1137, 0.6444, 0.1301],
         [0.5181, 0.2647, 0.0880, 0.2270, 0.6046],
         [0.1972, 0.4333, 0.7171, 0.9073, 0.4942]]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>ex4.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>3</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>ex4.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>torch.Size([2, 4, 5])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>ex5<span class="op">=</span>torch.rand(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>ex5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>tensor([[[0.7789, 0.1682],
         [0.0094, 0.2445],
         [0.8911, 0.8321]],

        [[0.1200, 0.3260],
         [0.3457, 0.2957],
         [0.4098, 0.7482]],

        [[0.3866, 0.8168],
         [0.4305, 0.2413],
         [0.8641, 0.3003]],

        [[0.0059, 0.5729],
         [0.3734, 0.2545],
         [0.6897, 0.0118]]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>ex5.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>3</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>ex.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>torch.Size([3, 2])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>ex6<span class="op">=</span>torch.rand(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">5</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>ex6</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>tensor([[[[0.9931, 0.1168, 0.6716, 0.1681, 0.4354],
          [0.5095, 0.5501, 0.7275, 0.0465, 0.7774],
          [0.4128, 0.4399, 0.2902, 0.0855, 0.0089]],

         [[0.1425, 0.3474, 0.4017, 0.3200, 0.7337],
          [0.9222, 0.8889, 0.0237, 0.6372, 0.7848],
          [0.7411, 0.3156, 0.3671, 0.3514, 0.2942]],

         [[0.4480, 0.2421, 0.8844, 0.7294, 0.2559],
          [0.3428, 0.3152, 0.7915, 0.2410, 0.8635],
          [0.3690, 0.6569, 0.6382, 0.9779, 0.8057]],

         [[0.1643, 0.5866, 0.4884, 0.3975, 0.0647],
          [0.2299, 0.9929, 0.2179, 0.5184, 0.9253],
          [0.0221, 0.1830, 0.4195, 0.6929, 0.5759]]],


        [[[0.9516, 0.1911, 0.7478, 0.5186, 0.0919],
          [0.9706, 0.1871, 0.0041, 0.0241, 0.3407],
          [0.3150, 0.0383, 0.3816, 0.4461, 0.0336]],

         [[0.3946, 0.5747, 0.8072, 0.5822, 0.2242],
          [0.5933, 0.1112, 0.2253, 0.3920, 0.7162],
          [0.0453, 0.3017, 0.8724, 0.9880, 0.8047]],

         [[0.2868, 0.9855, 0.8950, 0.5879, 0.9848],
          [0.7208, 0.2909, 0.0047, 0.7693, 0.8669],
          [0.5762, 0.1647, 0.9850, 0.8583, 0.7998]],

         [[0.5251, 0.0835, 0.2995, 0.9137, 0.0712],
          [0.5983, 0.1219, 0.1641, 0.6429, 0.7465],
          [0.3766, 0.3345, 0.8705, 0.9843, 0.4925]]]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>ex6.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>4</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>ex6.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>torch.Size([2, 4, 3, 5])</code></pre>
</div>
</div>
<section id="probably-ndim-gives-the-number-of-dimensions-and-shape-gives-us-the-dimensions-of-the-tensoror-matrix-in-the-form-of-nxmx...." class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="probably-ndim-gives-the-number-of-dimensions-and-shape-gives-us-the-dimensions-of-the-tensoror-matrix-in-the-form-of-nxmx...."><span class="header-section-number">9.1</span> Probably, ndim gives the number of dimensions and shape gives us the dimensions of the tensor(or matrix) in the form of <span class="math inline">\(n\)</span>x<span class="math inline">\(m\)</span>x<span class="math inline">\(...\)</span>.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>TENSOR<span class="op">=</span>torch.tensor([[[<span class="dv">473</span>,<span class="dv">478</span>,<span class="dv">37</span>],</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>                      [<span class="dv">273</span>,<span class="dv">472</span>,<span class="dv">72</span>],</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>                      [<span class="dv">72819</span>,<span class="dv">47</span>,<span class="dv">281</span>]]])</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>TENSOR</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>tensor([[[  473,   478,    37],
         [  273,   472,    72],
         [72819,    47,   281]]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>TENSOR.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>3</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>TENSOR.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>torch.Size([1, 3, 3])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>TENSOR2<span class="op">=</span>torch.tensor([[[<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">73</span>],[<span class="dv">27</span>,<span class="dv">73</span>,<span class="dv">21</span>],</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>                      [<span class="dv">27</span>,<span class="dv">65</span>,<span class="dv">36</span>],[<span class="dv">10</span>,<span class="dv">738</span>,<span class="dv">98</span>],</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>                      [<span class="dv">472</span>,<span class="dv">73</span>,<span class="dv">63</span>],[<span class="dv">73</span>,<span class="dv">482</span>,<span class="dv">63</span>]],[[<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">73</span>],[<span class="dv">27</span>,<span class="dv">73</span>,<span class="dv">21</span>],</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>                      [<span class="dv">27</span>,<span class="dv">65</span>,<span class="dv">36</span>],[<span class="dv">10</span>,<span class="dv">738</span>,<span class="dv">98</span>],</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>                      [<span class="dv">472</span>,<span class="dv">73</span>,<span class="dv">63</span>],[<span class="dv">73</span>,<span class="dv">482</span>,<span class="dv">63</span>]]])</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>TENSOR2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>tensor([[[  2,   3,  73],
         [ 27,  73,  21],
         [ 27,  65,  36],
         [ 10, 738,  98],
         [472,  73,  63],
         [ 73, 482,  63]],

        [[  2,   3,  73],
         [ 27,  73,  21],
         [ 27,  65,  36],
         [ 10, 738,  98],
         [472,  73,  63],
         [ 73, 482,  63]]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>TENSOR2.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>3</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>TENSOR2.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>torch.Size([2, 6, 3])</code></pre>
</div>
</div>
<p>By Convention, we use all caps for tensors and matrices and lower case for vectors and scalars. There are no terms as scalars, vectors, matrices in the syntax. All of them are tensors. The shape and dimensions of the tensor define the term used.</p>
<p>To Summarize</p>
<table class="table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>What is it?</th>
<th>Number of dimensions</th>
<th>Lower or upper (usually/example)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>scalar</strong></td>
<td>a single number</td>
<td>0</td>
<td>Lower (<code>a</code>)</td>
</tr>
<tr class="even">
<td><strong>vector</strong></td>
<td>a number with direction (e.g.&nbsp;wind speed with direction) but can also have many other numbers</td>
<td>1</td>
<td>Lower (<code>y</code>)</td>
</tr>
<tr class="odd">
<td><strong>matrix</strong></td>
<td>a 2-dimensional array of numbers</td>
<td>2</td>
<td>Upper (<code>Q</code>)</td>
</tr>
<tr class="even">
<td><strong>tensor</strong></td>
<td>an n-dimensional array of numbers</td>
<td>can be any number, a 0-dimension tensor is a scalar, a 1-dimension tensor is a vector</td>
<td>Upper (<code>X</code>)</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Random tensors</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>rand_ten<span class="op">=</span> torch.rand(size<span class="op">=</span>(<span class="dv">5</span>,<span class="dv">3</span>))</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>rand_ten,rand_ten.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>(tensor([[0.9307, 0.2047, 0.9102],
         [0.7537, 0.7382, 0.4093],
         [0.8215, 0.6938, 0.3436],
         [0.6726, 0.6349, 0.0772],
         [0.1314, 0.2939, 0.3545]]),
 torch.float32)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>rand_ten.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>torch.float32</code></pre>
</div>
</div>
<p>For Example, if we want to create a tensor for the common image shape of (224, 224, 3) ie, (Height, Width, Color Channels).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>rand_image<span class="op">=</span>torch.rand(size<span class="op">=</span>(<span class="dv">3</span>,<span class="dv">224</span>,<span class="dv">224</span>))</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>rand_image</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>tensor([[[0.7235, 0.3475, 0.1128,  ..., 0.7870, 0.7319, 0.6244],
         [0.9130, 0.7502, 0.0262,  ..., 0.5601, 0.3764, 0.1332],
         [0.0326, 0.0666, 0.0381,  ..., 0.5440, 0.0450, 0.7834],
         ...,
         [0.3312, 0.3437, 0.1137,  ..., 0.1090, 0.7219, 0.3526],
         [0.7155, 0.0402, 0.0209,  ..., 0.2060, 0.9748, 0.8547],
         [0.4337, 0.9035, 0.8697,  ..., 0.0928, 0.6882, 0.6823]],

        [[0.3749, 0.1274, 0.0679,  ..., 0.9208, 0.5695, 0.1757],
         [0.6695, 0.3983, 0.9633,  ..., 0.1439, 0.8342, 0.6253],
         [0.7849, 0.3406, 0.0078,  ..., 0.8696, 0.3369, 0.3489],
         ...,
         [0.9902, 0.3673, 0.7743,  ..., 0.1442, 0.0641, 0.2402],
         [0.9773, 0.6198, 0.4050,  ..., 0.0056, 0.1235, 0.4614],
         [0.1538, 0.6105, 0.3765,  ..., 0.9220, 0.4059, 0.7821]],

        [[0.9005, 0.4082, 0.3391,  ..., 0.3896, 0.9649, 0.3884],
         [0.1506, 0.6456, 0.9188,  ..., 0.2503, 0.1541, 0.5787],
         [0.9122, 0.1805, 0.5534,  ..., 0.4106, 0.3451, 0.9317],
         ...,
         [0.5601, 0.9080, 0.5195,  ..., 0.4821, 0.3404, 0.2160],
         [0.1838, 0.3120, 0.9754,  ..., 0.7687, 0.1310, 0.8943],
         [0.3991, 0.7130, 0.2392,  ..., 0.6545, 0.3912, 0.6865]]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>rand_image.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>3</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>rand_image.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>torch.Size([3, 224, 224])</code></pre>
</div>
</div>
<p>To create a tensor with just aeros (used to mask values which we dont need the model to learn)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>zeros<span class="op">=</span>torch.zeros(size<span class="op">=</span>(<span class="dv">5</span>,<span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>zeros</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>tensor([[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>zeros.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>torch.float32</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>ones<span class="op">=</span>torch.ones(size<span class="op">=</span>(<span class="dv">5</span>,<span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>ones</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>tensor([[1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>ones.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>torch.float32</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>zero_ten<span class="op">=</span>torch.arange(start<span class="op">=</span><span class="dv">0</span>,end<span class="op">=</span><span class="dv">10</span>,step<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>zero_ten</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>zero_ten_three<span class="op">=</span>torch.arange(start<span class="op">=</span><span class="dv">0</span>,end<span class="op">=</span><span class="dv">10</span>,step<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>zero_ten_three</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>tensor([0, 3, 6, 9])</code></pre>
</div>
</div>
<p>To create a tensor with same shape as another :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>ten_ones<span class="op">=</span>torch.ones_like(<span class="bu">input</span><span class="op">=</span>zero_ten_three)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>ten_ones</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>tensor([1, 1, 1, 1])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>tensor_float_32<span class="op">=</span>torch.tensor([<span class="fl">3.0</span>,<span class="fl">6.0</span>,<span class="fl">1.0</span>],</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>                            dtype<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>tensor_float_32</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>tensor([3., 6., 1.])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>tensor_float_32.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>torch.float32</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>tensor_float_32.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>tensor_float_32.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>torch.Size([3])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>tensor_float_32.device</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>device(type='cpu')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>tensor_float_16<span class="op">=</span>torch.tensor([<span class="fl">3.0</span>,<span class="fl">6.0</span>,<span class="fl">10.2</span>],</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>                            dtype<span class="op">=</span>torch.float16)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>tensor_float_16</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>tensor([ 3.0000,  6.0000, 10.2031], dtype=torch.float16)</code></pre>
</div>
</div>
</section>
<section id="why-are-there-discrepensies-with-the-precision-digit-after-the-decimal-point" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Why are there discrepensies with the precision digit after the decimal point?</h1>
<p>It is because of float16 is less precise than float32 so due to the roundoff error there r slight dicrepancies but since it takes less space, its used in places where memory is a scarce resource.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>tensor_float_16.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>torch.float16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>some_tensor<span class="op">=</span>torch.rand(<span class="dv">5</span>,<span class="dv">4</span>)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>some_tensor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>tensor([[0.0316, 0.7063, 0.1055, 0.7054],
        [0.5167, 0.1111, 0.8219, 0.5887],
        [0.8636, 0.1042, 0.0918, 0.9745],
        [0.4481, 0.7971, 0.5347, 0.9317],
        [0.7867, 0.1356, 0.0354, 0.8421]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>some_tensor.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>torch.float32</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>some_tensor.device</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>device(type='cpu')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>some_tensor.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<pre><code>torch.Size([5, 4])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Shape of tensor : </span><span class="sc">{</span>some_tensor<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of tensor : torch.Size([5, 4])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Data Type of tensor : </span><span class="sc">{</span>some_tensor<span class="sc">.</span>dtype<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data Type of tensor : torch.float32</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Device of tensor : </span><span class="sc">{</span>some_tensor<span class="sc">.</span>device<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Device of tensor : cpu</code></pre>
</div>
</div>
<section id="tensor-operations" class="level3" data-number="10.0.1">
<h3 data-number="10.0.1" class="anchored" data-anchor-id="tensor-operations"><span class="header-section-number">10.0.1</span> Tensor Operations</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>tens<span class="op">=</span>torch.tensor([<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">8</span>])</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>tens<span class="op">+</span><span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>tensor([14, 12, 18])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>tens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>tensor([4, 2, 8])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>tens<span class="op">*</span><span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>tensor([40, 20, 80])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>tens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>tensor([4, 2, 8])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>tens<span class="op">-</span><span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>tensor([-6, -8, -2])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>tens<span class="op">=</span>tens<span class="op">-</span><span class="dv">10</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>tens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<pre><code>tensor([-6, -8, -2])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>torch.mul(tens,<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>tensor([-60, -80, -20])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>tens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>tensor([-6, -8, -2])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>torch.add(tens,<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">
<pre><code>tensor([4, 2, 8])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>torch.sub(tens,<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">
<pre><code>tensor([-16, -18, -12])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>torch.div(tens,<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">
<pre><code>tensor([-0.6000, -0.8000, -0.2000])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>tens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<pre><code>tensor([-6, -8, -2])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>tens<span class="op">/</span><span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>tensor([-0.6000, -0.8000, -0.2000])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>tens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="80">
<pre><code>tensor([-6, -8, -2])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>tens<span class="op">=</span>tens<span class="op">/</span><span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>tens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="82">
<pre><code>tensor([-0.6000, -0.8000, -0.2000])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>tens.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="83">
<pre><code>torch.float32</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>tens<span class="op">=</span>torch.tensor([<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">9</span>])</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>tens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">
<pre><code>tensor([3, 5, 9])</code></pre>
</div>
</div>
<p>Element wise multiplicaton:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>tens <span class="op">*</span> tens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="85">
<pre><code>tensor([ 9, 25, 81])</code></pre>
</div>
</div>
</section>
<section id="matrix-mult" class="level3" data-number="10.0.2">
<h3 data-number="10.0.2" class="anchored" data-anchor-id="matrix-mult"><span class="header-section-number">10.0.2</span> Matrix Mult</h3>
<p>For Matrix Mult, there are two rules to it : * Inner dimensions should match ex : (3,2) @ (2,5) Works but (2,5) @ (3,7) Doesnâ€™t * The resulting matrix should take the outer dimensions</p>
<p>Note: â€œ@â€ in Python is the symbol for matrix multiplication.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>tens<span class="op">=</span>torch.tensor([<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">8</span>])</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>tens.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<pre><code>torch.Size([3])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>tens<span class="op">*</span>tens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="87">
<pre><code>tensor([ 1, 16, 64])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>tens.matmul(tens)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="88">
<pre><code>tensor(81)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>torch.matmul(tens,tens)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<pre><code>tensor(81)</code></pre>
</div>
</div>
<div class="cell" data-tags="[]">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>tens<span class="op">@</span>tens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="90">
<pre><code>tensor(81)</code></pre>
</div>
</div>
<p>We can do matrix mult more primitively by setting up â€˜forâ€™ loops but it is very computationally expensive and shdnt be done unless we hv a better algorithm than matmul.</p>
<div class="cell" data-tags="[]">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>matmul<span class="op">=</span><span class="dv">0</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(tens)):</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>    matmul<span class="op">+=</span>tens[i]<span class="op">*</span>tens[i]</span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a>matmul</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: user 353 Âµs, sys: 0 ns, total: 353 Âµs
Wall time: 240 Âµs</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="91">
<pre><code>tensor(81)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>tens.matmul(tens)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: user 107 Âµs, sys: 19 Âµs, total: 126 Âµs
Wall time: 89.9 Âµs</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="92">
<pre><code>tensor(81)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>torch.matmul(tens,tens)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: user 115 Âµs, sys: 21 Âµs, total: 136 Âµs
Wall time: 97.5 Âµs</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="93">
<pre><code>tensor(81)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>tens_a<span class="op">=</span>torch.tensor([[<span class="dv">2</span>,<span class="dv">6</span>],</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>                    [<span class="dv">3</span>,<span class="dv">6</span>],</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>                    [<span class="dv">1</span>,<span class="dv">7</span>]])</span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>tens_b<span class="op">=</span>torch.tensor([[<span class="dv">48</span>,<span class="dv">82</span>],</span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>                    [<span class="dv">72</span>,<span class="dv">83</span>],</span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>                    [<span class="dv">24</span>,<span class="dv">57</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>tens_a.shape, tens_b.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="95">
<pre><code>(torch.Size([3, 2]), torch.Size([3, 2]))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>tens_a<span class="op">*</span>tens_b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="96">
<pre><code>tensor([[ 96, 492],
        [216, 498],
        [ 24, 399]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># matmul(tens_a,tens_b)</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This wont run coz the shapes r 3*2 and 3*2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can make it work by transposing either of the matrices</p>
<ul>
<li>torch.transpose(input, dim0, dim1) - where input is the desired tensor to transpose and dim0 and dim1 are the dimensions to be swapped.</li>
<li>tensor.T - where tensor is the desired tensor to transpose.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>tens_a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="98">
<pre><code>tensor([[2, 6],
        [3, 6],
        [1, 7]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>tens_b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="99">
<pre><code>tensor([[48, 82],
        [72, 83],
        [24, 57]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>tens_b.T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="100">
<pre><code>tensor([[48, 72, 24],
        [82, 83, 57]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>torch.matmul(tens_a,tens_b.T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="101">
<pre><code>tensor([[588, 642, 390],
        [636, 714, 414],
        [622, 653, 423]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>tens_a.matmul(tens_b.T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="102">
<pre><code>tensor([[588, 642, 390],
        [636, 714, 414],
        [622, 653, 423]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>tens_a.mm(tens_b.T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="103">
<pre><code>tensor([[588, 642, 390],
        [636, 714, 414],
        [622, 653, 423]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>torch.mm(tens_a,tens_b.T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="104">
<pre><code>tensor([[588, 642, 390],
        [636, 714, 414],
        [622, 653, 423]])</code></pre>
</div>
</div>
<p>The torch.nn.Linear() module also known as a feed-forward layer or fully connected layer, implements a matrix multiplication between an input x and a weights matrix A.</p>
<p><span class="math display">\[y = x \cdot A^\intercal + b\]</span></p>
<p>x is the input to the layer (deep learning is a stack of layers like torch.nn.Linear() and others on top of each other).</p>
<p>A is the weights matrix created by the layer, this starts out as random numbers that get adjusted as a neural network learns to better represent patterns in the data (notice the T, thatâ€™s because the weights matrix gets transposed). Note: You might also often see W or another letter like X used to showcase the weights matrix.</p>
<p>b is the bias term used to slightly offset the weights and inputs.</p>
<p>y is the output (a manipulation of the input in the hopes to discover patterns in it).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Since the linear layer starts with a random weights matrix, let's make it reproducible (more on this later)</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(<span class="dv">42</span>)</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This uses matrix multiplication</span></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>linear <span class="op">=</span> torch.nn.Linear(in_features<span class="op">=</span><span class="dv">2</span>, <span class="co"># in_features = matches inner dimension of input </span></span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>                         out_features<span class="op">=</span><span class="dv">6</span>) <span class="co"># out_features = describes outer value </span></span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> torch.rand(<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a>output <span class="op">=</span> linear(x)</span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Input shape: </span><span class="sc">{</span>x<span class="sc">.</span>shape<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Output:</span><span class="ch">\n</span><span class="sc">{</span>output<span class="sc">}</span><span class="ch">\n\n</span><span class="ss">Output shape: </span><span class="sc">{</span>output<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Input shape: torch.Size([3, 2])

Output:
tensor([[ 1.0348,  0.4592,  0.3892,  0.0690,  0.3858,  0.3514],
        [ 0.9272,  0.3378,  0.3622, -0.0094,  0.4842,  0.3286],
        [ 1.1711,  0.5868,  0.4136,  0.1433,  0.2987,  0.3971]],
       grad_fn=&lt;AddmmBackward0&gt;)

Output shape: torch.Size([3, 6])</code></pre>
</div>
</div>
</section>
<section id="agregation" class="level3" data-number="10.0.3">
<h3 data-number="10.0.3" class="anchored" data-anchor-id="agregation"><span class="header-section-number">10.0.3</span> Agregation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>torch.arange(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">10</span>)</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="106">
<pre><code>tensor([ 0, 10, 20, 30, 40, 50, 60, 70, 80, 90])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Minimum: </span><span class="sc">{</span>x<span class="sc">.</span><span class="bu">min</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Maximum: </span><span class="sc">{</span>x<span class="sc">.</span><span class="bu">max</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mean: </span><span class="sc">{</span>x<span class="sc">.</span><span class="bu">type</span>(torch.float32)<span class="sc">.</span>mean()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sum: </span><span class="sc">{</span>x<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Minimum: 0
Maximum: 90
Mean: 45.0
Sum: 450</code></pre>
</div>
</div>
<p><code>print(f"Mean: {x.mean()}")</code> will error<br>
Mean wonâ€™t work without the float datatype :<br>
<code>print(f"Mean: {x.type(torch.float32).mean()}")</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="108">
<pre><code>tensor([ 0, 10, 20, 30, 40, 50, 60, 70, 80, 90])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>x.<span class="bu">max</span>(),x.<span class="bu">min</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="109">
<pre><code>(tensor(90), tensor(0))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>x.<span class="bu">type</span>(torch.float32).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="110">
<pre><code>tensor(45.)</code></pre>
</div>
</div>
<p>We can also use <code>torch.max()</code> , <code>torch.min()</code> etc</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>torch.<span class="bu">max</span>(x), torch.<span class="bu">min</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="111">
<pre><code>(tensor(90), tensor(0))</code></pre>
</div>
</div>
<p>We can use <code>argmax(.)</code>,<code>argmin(.)</code> to find the index of the max or min value</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>torch.argmax(x), torch.argmin(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="112">
<pre><code>(tensor(9), tensor(0))</code></pre>
</div>
</div>
</section>
<section id="changing-datatype-of-a-tensor" class="level3" data-number="10.0.4">
<h3 data-number="10.0.4" class="anchored" data-anchor-id="changing-datatype-of-a-tensor"><span class="header-section-number">10.0.4</span> Changing Datatype of a tensor</h3>
<p>To change the data type of a tensor we use <code>type(type.__)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>tens<span class="op">=</span>torch.arange(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">10</span>)</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>tens,tens.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="113">
<pre><code>(tensor([ 1, 11, 21, 31, 41, 51, 61, 71, 81, 91]), torch.int64)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>tens_float32<span class="op">=</span>tens.<span class="bu">type</span>(torch.float32)</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>tens_float32,tens_float32.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="114">
<pre><code>(tensor([ 1., 11., 21., 31., 41., 51., 61., 71., 81., 91.]), torch.float32)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>tens_int64<span class="op">=</span>tens_float32.<span class="bu">type</span>(torch.int64)</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>tens_int64,tens_int64.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="115">
<pre><code>(tensor([ 1, 11, 21, 31, 41, 51, 61, 71, 81, 91]), torch.int64)</code></pre>
</div>
</div>
</section>
<section id="reshaping-stacking-squeezing-unsqueezing" class="level3" data-number="10.0.5">
<h3 data-number="10.0.5" class="anchored" data-anchor-id="reshaping-stacking-squeezing-unsqueezing"><span class="header-section-number">10.0.5</span> Reshaping, Stacking, Squeezing, Unsqueezing</h3>
<section id="reshape" class="level4" data-number="10.0.5.1">
<h4 data-number="10.0.5.1" class="anchored" data-anchor-id="reshape"><span class="header-section-number">10.0.5.1</span> Reshape</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>torch.arange(<span class="dv">1</span>,<span class="dv">8</span>)</span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>x,x.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="116">
<pre><code>(tensor([1, 2, 3, 4, 5, 6, 7]), torch.Size([7]))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>x.reshape(<span class="dv">1</span>,<span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="117">
<pre><code>tensor([[1, 2, 3, 4, 5, 6, 7]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>x.reshape(<span class="dv">7</span>,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="118">
<pre><code>tensor([[1],
        [2],
        [3],
        [4],
        [5],
        [6],
        [7]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>x.reshape(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="119">
<pre><code>tensor([[[1, 2, 3, 4, 5, 6, 7]]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>x.reshape(<span class="dv">7</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="120">
<pre><code>tensor([[[1]],

        [[2]],

        [[3]],

        [[4]],

        [[5]],

        [[6]],

        [[7]]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>tens<span class="op">=</span>torch.randint(low<span class="op">=</span><span class="dv">0</span>, high<span class="op">=</span><span class="dv">25</span>, size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>))</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>tens,tens.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="121">
<pre><code>(tensor([[[24, 13, 16, 19],
          [12, 19, 22,  5],
          [ 0,  4,  8, 14]],
 
         [[14,  1,  7, 10],
          [11, 22,  2, 19],
          [ 7, 23, 18, 19]]]),
 torch.Size([2, 3, 4]))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>tens.reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="122">
<pre><code>tensor([[[[24, 13, 16, 19]],

         [[12, 19, 22,  5]],

         [[ 0,  4,  8, 14]]],


        [[[14,  1,  7, 10]],

         [[11, 22,  2, 19]],

         [[ 7, 23, 18, 19]]]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>tens.reshape(<span class="dv">2</span>,<span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="123">
<pre><code>tensor([[24, 13, 16, 19, 12, 19, 22,  5,  0,  4,  8, 14],
        [14,  1,  7, 10, 11, 22,  2, 19,  7, 23, 18, 19]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>tens.reshape(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="124">
<pre><code>tensor([[[24, 13, 16],
         [19, 12, 19]],

        [[22,  5,  0],
         [ 4,  8, 14]],

        [[14,  1,  7],
         [10, 11, 22]],

        [[ 2, 19,  7],
         [23, 18, 19]]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>tens.reshape(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="125">
<pre><code>tensor([[[24, 13],
         [16, 19],
         [12, 19]],

        [[22,  5],
         [ 0,  4],
         [ 8, 14]],

        [[14,  1],
         [ 7, 10],
         [11, 22]],

        [[ 2, 19],
         [ 7, 23],
         [18, 19]]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>tens.reshape(<span class="dv">6</span>,<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="126">
<pre><code>tensor([[24, 13, 16, 19],
        [12, 19, 22,  5],
        [ 0,  4,  8, 14],
        [14,  1,  7, 10],
        [11, 22,  2, 19],
        [ 7, 23, 18, 19]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a>tens.reshape(<span class="dv">8</span>,<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="127">
<pre><code>tensor([[24, 13, 16],
        [19, 12, 19],
        [22,  5,  0],
        [ 4,  8, 14],
        [14,  1,  7],
        [10, 11, 22],
        [ 2, 19,  7],
        [23, 18, 19]])</code></pre>
</div>
</div>
</section>
<section id="view" class="level4" data-number="10.0.5.2">
<h4 data-number="10.0.5.2" class="anchored" data-anchor-id="view"><span class="header-section-number">10.0.5.2</span> View</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>z<span class="op">=</span>tens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>z.view(<span class="dv">2</span>,<span class="dv">12</span>)</span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="129">
<pre><code>tensor([[24, 13, 16, 19, 12, 19, 22,  5,  0,  4,  8, 14],
        [14,  1,  7, 10, 11, 22,  2, 19,  7, 23, 18, 19]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span>z.reshape(<span class="dv">2</span>,<span class="dv">12</span>)</span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="130">
<pre><code>tensor([[24, 13, 16, 19, 12, 19, 22,  5,  0,  4,  8, 14],
        [14,  1,  7, 10, 11, 22,  2, 19,  7, 23, 18, 19]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>z[:,<span class="dv">0</span>]<span class="op">=</span><span class="dv">5</span></span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a>z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="131">
<pre><code>tensor([[[ 5,  5,  5,  5],
         [12, 19, 22,  5],
         [ 0,  4,  8, 14]],

        [[ 5,  5,  5,  5],
         [11, 22,  2, 19],
         [ 7, 23, 18, 19]]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="132">
<pre><code>tensor([[ 5,  5,  5,  5, 12, 19, 22,  5,  0,  4,  8, 14],
        [ 5,  5,  5,  5, 11, 22,  2, 19,  7, 23, 18, 19]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="133">
<pre><code>tensor([[ 5,  5,  5,  5, 12, 19, 22,  5,  0,  4,  8, 14],
        [ 5,  5,  5,  5, 11, 22,  2, 19,  7, 23, 18, 19]])</code></pre>
</div>
</div>
<p>Even when we change the viewed and reshaped tensors both the viewed and reshaped tensor change the original tensor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">0</span>,<span class="dv">0</span>]<span class="op">=</span><span class="dv">6969</span></span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="134">
<pre><code>tensor([[6969,    5,    5,    5,   12,   19,   22,    5,    0,    4,    8,   14],
        [   5,    5,    5,    5,   11,   22,    2,   19,    7,   23,   18,   19]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a>z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="135">
<pre><code>tensor([[[6969,    5,    5,    5],
         [  12,   19,   22,    5],
         [   0,    4,    8,   14]],

        [[   5,    5,    5,    5],
         [  11,   22,    2,   19],
         [   7,   23,   18,   19]]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="136">
<pre><code>tensor([[6969,    5,    5,    5,   12,   19,   22,    5,    0,    4,    8,   14],
        [   5,    5,    5,    5,   11,   22,    2,   19,    7,   23,   18,   19]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a>y[<span class="dv">0</span>,<span class="dv">0</span>]<span class="op">=</span><span class="dv">10</span></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="137">
<pre><code>tensor([[10,  5,  5,  5, 12, 19, 22,  5,  0,  4,  8, 14],
        [ 5,  5,  5,  5, 11, 22,  2, 19,  7, 23, 18, 19]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a>z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="138">
<pre><code>tensor([[[10,  5,  5,  5],
         [12, 19, 22,  5],
         [ 0,  4,  8, 14]],

        [[ 5,  5,  5,  5],
         [11, 22,  2, 19],
         [ 7, 23, 18, 19]]])</code></pre>
</div>
</div>
<p>This is because both view and reshape share the underlying data with teh original tensor so making changes in any will reflect on the other.</p>
</section>
<section id="squeeze-unsqueeze" class="level4" data-number="10.0.5.3">
<h4 data-number="10.0.5.3" class="anchored" data-anchor-id="squeeze-unsqueeze"><span class="header-section-number">10.0.5.3</span> Squeeze / Unsqueeze</h4>
<p><code>squeeze()</code> returns a tensor with all the dimensions of size 1 removed. Unsqueeze adds a dimension of size 1 inserted at the specified position.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>tens,tens.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="139">
<pre><code>(tensor([[[10,  5,  5,  5],
          [12, 19, 22,  5],
          [ 0,  4,  8, 14]],
 
         [[ 5,  5,  5,  5],
          [11, 22,  2, 19],
          [ 7, 23, 18, 19]]]),
 torch.Size([2, 3, 4]))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>tens.squeeze()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="140">
<pre><code>tensor([[[10,  5,  5,  5],
         [12, 19, 22,  5],
         [ 0,  4,  8, 14]],

        [[ 5,  5,  5,  5],
         [11, 22,  2, 19],
         [ 7, 23, 18, 19]]])</code></pre>
</div>
</div>
<p>When theres no size 1 dimension, squeeze returns the original tensor</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a>ex1<span class="op">=</span>torch.arange(<span class="dv">1</span>,<span class="dv">26</span>).reshape(<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">5</span>)</span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a>ex1,ex1.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="141">
<pre><code>(tensor([[[ 1,  2,  3,  4,  5]],
 
         [[ 6,  7,  8,  9, 10]],
 
         [[11, 12, 13, 14, 15]],
 
         [[16, 17, 18, 19, 20]],
 
         [[21, 22, 23, 24, 25]]]),
 torch.Size([5, 1, 5]))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a>ex1.squeeze(), ex1.squeeze().shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="142">
<pre><code>(tensor([[ 1,  2,  3,  4,  5],
         [ 6,  7,  8,  9, 10],
         [11, 12, 13, 14, 15],
         [16, 17, 18, 19, 20],
         [21, 22, 23, 24, 25]]),
 torch.Size([5, 5]))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a>ex1, ex1.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="143">
<pre><code>(tensor([[[ 1,  2,  3,  4,  5]],
 
         [[ 6,  7,  8,  9, 10]],
 
         [[11, 12, 13, 14, 15]],
 
         [[16, 17, 18, 19, 20]],
 
         [[21, 22, 23, 24, 25]]]),
 torch.Size([5, 1, 5]))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>ex1.unsqueeze(<span class="dv">0</span>), ex1.unsqueeze(<span class="dv">0</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="144">
<pre><code>(tensor([[[[ 1,  2,  3,  4,  5]],
 
          [[ 6,  7,  8,  9, 10]],
 
          [[11, 12, 13, 14, 15]],
 
          [[16, 17, 18, 19, 20]],
 
          [[21, 22, 23, 24, 25]]]]),
 torch.Size([1, 5, 1, 5]))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a>ex1.unsqueeze(<span class="dv">1</span>), ex1.unsqueeze(<span class="dv">1</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="145">
<pre><code>(tensor([[[[ 1,  2,  3,  4,  5]]],
 
 
         [[[ 6,  7,  8,  9, 10]]],
 
 
         [[[11, 12, 13, 14, 15]]],
 
 
         [[[16, 17, 18, 19, 20]]],
 
 
         [[[21, 22, 23, 24, 25]]]]),
 torch.Size([5, 1, 1, 5]))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a>ex1.squeeze().unsqueeze(<span class="dv">0</span>), ex1.squeeze().unsqueeze(<span class="dv">0</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="146">
<pre><code>(tensor([[[ 1,  2,  3,  4,  5],
          [ 6,  7,  8,  9, 10],
          [11, 12, 13, 14, 15],
          [16, 17, 18, 19, 20],
          [21, 22, 23, 24, 25]]]),
 torch.Size([1, 5, 5]))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a>ex1.squeeze().unsqueeze(<span class="dv">1</span>),ex1.squeeze().unsqueeze(<span class="dv">1</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="147">
<pre><code>(tensor([[[ 1,  2,  3,  4,  5]],
 
         [[ 6,  7,  8,  9, 10]],
 
         [[11, 12, 13, 14, 15]],
 
         [[16, 17, 18, 19, 20]],
 
         [[21, 22, 23, 24, 25]]]),
 torch.Size([5, 1, 5]))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a>ex1, ex1.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="148">
<pre><code>(tensor([[[ 1,  2,  3,  4,  5]],
 
         [[ 6,  7,  8,  9, 10]],
 
         [[11, 12, 13, 14, 15]],
 
         [[16, 17, 18, 19, 20]],
 
         [[21, 22, 23, 24, 25]]]),
 torch.Size([5, 1, 5]))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a>ex1.unsqueeze(<span class="dv">2</span>),ex1.unsqueeze(<span class="dv">2</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="149">
<pre><code>(tensor([[[[ 1,  2,  3,  4,  5]]],
 
 
         [[[ 6,  7,  8,  9, 10]]],
 
 
         [[[11, 12, 13, 14, 15]]],
 
 
         [[[16, 17, 18, 19, 20]]],
 
 
         [[[21, 22, 23, 24, 25]]]]),
 torch.Size([5, 1, 1, 5]))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a>ex1.unsqueeze(<span class="dv">3</span>),ex1.unsqueeze(<span class="dv">3</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="150">
<pre><code>(tensor([[[[ 1],
           [ 2],
           [ 3],
           [ 4],
           [ 5]]],
 
 
         [[[ 6],
           [ 7],
           [ 8],
           [ 9],
           [10]]],
 
 
         [[[11],
           [12],
           [13],
           [14],
           [15]]],
 
 
         [[[16],
           [17],
           [18],
           [19],
           [20]]],
 
 
         [[[21],
           [22],
           [23],
           [24],
           [25]]]]),
 torch.Size([5, 1, 5, 1]))</code></pre>
</div>
</div>
<p><code>ex1.unsqueeze(4),ex1.unsqueeze(4).shape</code> gives error dimension out of range.</p>
</section>
<section id="permute" class="level4" data-number="10.0.5.4">
<h4 data-number="10.0.5.4" class="anchored" data-anchor-id="permute"><span class="header-section-number">10.0.5.4</span> Permute</h4>
<p><code>permute()</code> gives us a <strong>view</strong> by rearranging the dimensions of the input tensor according to the indices provided as arguments.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a>tens<span class="op">=</span>torch.arange(<span class="dv">1</span>,<span class="dv">25</span>).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>tens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="151">
<pre><code>tensor([[[ 1,  2,  3,  4],
         [ 5,  6,  7,  8],
         [ 9, 10, 11, 12]],

        [[13, 14, 15, 16],
         [17, 18, 19, 20],
         [21, 22, 23, 24]]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a>tens.permute(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>), tens.permute(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="152">
<pre><code>(tensor([[[ 1,  5,  9],
          [13, 17, 21]],
 
         [[ 2,  6, 10],
          [14, 18, 22]],
 
         [[ 3,  7, 11],
          [15, 19, 23]],
 
         [[ 4,  8, 12],
          [16, 20, 24]]]),
 torch.Size([4, 2, 3]))</code></pre>
</div>
</div>
</section>
</section>
<section id="indexing" class="level3" data-number="10.0.6">
<h3 data-number="10.0.6" class="anchored" data-anchor-id="indexing"><span class="header-section-number">10.0.6</span> Indexing</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a>tens<span class="op">=</span>torch.arange(<span class="dv">1</span>,<span class="dv">33</span>).reshape(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a>tens,tens.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="153">
<pre><code>(tensor([[[ 1,  2,  3,  4],
          [ 5,  6,  7,  8],
          [ 9, 10, 11, 12],
          [13, 14, 15, 16]],
 
         [[17, 18, 19, 20],
          [21, 22, 23, 24],
          [25, 26, 27, 28],
          [29, 30, 31, 32]]]),
 torch.Size([2, 4, 4]))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking out some doubts about 1D tensors</span></span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>tens<span class="op">=</span>torch.randn(<span class="dv">1</span>)</span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a>tens,tens.shape,tens.ndim</span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-5"><a href="#cb303-5" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>tens.unsqueeze(<span class="dv">1</span>)</span>
<span id="cb303-6"><a href="#cb303-6" aria-hidden="true" tabindex="-1"></a>tens.unsqueeze(<span class="dv">1</span>),tens.unsqueeze(<span class="dv">1</span>).shape,tens.unsqueeze(<span class="dv">1</span>).ndim</span>
<span id="cb303-7"><a href="#cb303-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-8"><a href="#cb303-8" aria-hidden="true" tabindex="-1"></a>x.unsqueeze(<span class="dv">1</span>)</span>
<span id="cb303-9"><a href="#cb303-9" aria-hidden="true" tabindex="-1"></a>x.unsqueeze(<span class="dv">1</span>),x.unsqueeze(<span class="dv">1</span>).shape, x.unsqueeze(<span class="dv">1</span>).ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="154">
<pre><code>(tensor([[[0.2815]]]), torch.Size([1, 1, 1]), 3)</code></pre>
</div>
</div>
<div class="cell" data-tags="[]">
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a>tens, tens[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="155">
<pre><code>(tensor([0.2815]), tensor(0.2815))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a>tens<span class="op">=</span>torch.arange(<span class="dv">1</span>,<span class="dv">181</span>).reshape(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">6</span>)</span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>tens,tens.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="156">
<pre><code>(tensor([[[[  1,   2,   3,   4,   5,   6],
           [  7,   8,   9,  10,  11,  12],
           [ 13,  14,  15,  16,  17,  18],
           [ 19,  20,  21,  22,  23,  24],
           [ 25,  26,  27,  28,  29,  30]],
 
          [[ 31,  32,  33,  34,  35,  36],
           [ 37,  38,  39,  40,  41,  42],
           [ 43,  44,  45,  46,  47,  48],
           [ 49,  50,  51,  52,  53,  54],
           [ 55,  56,  57,  58,  59,  60]]],
 
 
         [[[ 61,  62,  63,  64,  65,  66],
           [ 67,  68,  69,  70,  71,  72],
           [ 73,  74,  75,  76,  77,  78],
           [ 79,  80,  81,  82,  83,  84],
           [ 85,  86,  87,  88,  89,  90]],
 
          [[ 91,  92,  93,  94,  95,  96],
           [ 97,  98,  99, 100, 101, 102],
           [103, 104, 105, 106, 107, 108],
           [109, 110, 111, 112, 113, 114],
           [115, 116, 117, 118, 119, 120]]],
 
 
         [[[121, 122, 123, 124, 125, 126],
           [127, 128, 129, 130, 131, 132],
           [133, 134, 135, 136, 137, 138],
           [139, 140, 141, 142, 143, 144],
           [145, 146, 147, 148, 149, 150]],
 
          [[151, 152, 153, 154, 155, 156],
           [157, 158, 159, 160, 161, 162],
           [163, 164, 165, 166, 167, 168],
           [169, 170, 171, 172, 173, 174],
           [175, 176, 177, 178, 179, 180]]]]),
 torch.Size([3, 2, 5, 6]))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a>tens[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="157">
<pre><code>tensor([[[ 1,  2,  3,  4,  5,  6],
         [ 7,  8,  9, 10, 11, 12],
         [13, 14, 15, 16, 17, 18],
         [19, 20, 21, 22, 23, 24],
         [25, 26, 27, 28, 29, 30]],

        [[31, 32, 33, 34, 35, 36],
         [37, 38, 39, 40, 41, 42],
         [43, 44, 45, 46, 47, 48],
         [49, 50, 51, 52, 53, 54],
         [55, 56, 57, 58, 59, 60]]])</code></pre>
</div>
</div>
<p><code>[0]</code> gives us the first <span class="math inline">\(n-1\)</span> order tensor where <span class="math inline">\(n\)</span> is the ndim of the input tensor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a>tens[<span class="dv">0</span>][<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="158">
<pre><code>tensor([[ 1,  2,  3,  4,  5,  6],
        [ 7,  8,  9, 10, 11, 12],
        [13, 14, 15, 16, 17, 18],
        [19, 20, 21, 22, 23, 24],
        [25, 26, 27, 28, 29, 30]])</code></pre>
</div>
</div>
<p><code>[0]</code> gives us the first <span class="math inline">\(n-2\)</span> order tensor where <span class="math inline">\(n\)</span> is the ndim of the input tensor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a>tens[<span class="dv">0</span>][<span class="dv">0</span>][<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="159">
<pre><code>tensor([1, 2, 3, 4, 5, 6])</code></pre>
</div>
</div>
<p><code>[0]</code> gives us the first <span class="math inline">\(n-3\)</span> order tensor where <span class="math inline">\(n\)</span> is the ndim of the input tensor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a>tens[<span class="dv">0</span>][<span class="dv">0</span>][<span class="dv">0</span>][<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="160">
<pre><code>tensor(1)</code></pre>
</div>
</div>
<p><code>[0]</code> gives us the first <span class="math inline">\(n-4\)</span> order tensor where <span class="math inline">\(n\)</span> is the ndim of the input tensor.</p>
<ul>
<li>So in general, <code>[0]</code><span class="math inline">\(^m\)</span> gives us the first <span class="math inline">\(n-m\)</span> tensor where n is the ndim of the input tensor and m is the number of times theres <code>[0]</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a>tens[<span class="dv">2</span>][<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="161">
<pre><code>tensor([[151, 152, 153, 154, 155, 156],
        [157, 158, 159, 160, 161, 162],
        [163, 164, 165, 166, 167, 168],
        [169, 170, 171, 172, 173, 174],
        [175, 176, 177, 178, 179, 180]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a>tens[<span class="dv">2</span>:,<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="162">
<pre><code>tensor([[[151, 152, 153, 154, 155, 156],
         [157, 158, 159, 160, 161, 162],
         [163, 164, 165, 166, 167, 168],
         [169, 170, 171, 172, 173, 174],
         [175, 176, 177, 178, 179, 180]]])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a>tens, tens.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="163">
<pre><code>(tensor([[[[  1,   2,   3,   4,   5,   6],
           [  7,   8,   9,  10,  11,  12],
           [ 13,  14,  15,  16,  17,  18],
           [ 19,  20,  21,  22,  23,  24],
           [ 25,  26,  27,  28,  29,  30]],
 
          [[ 31,  32,  33,  34,  35,  36],
           [ 37,  38,  39,  40,  41,  42],
           [ 43,  44,  45,  46,  47,  48],
           [ 49,  50,  51,  52,  53,  54],
           [ 55,  56,  57,  58,  59,  60]]],
 
 
         [[[ 61,  62,  63,  64,  65,  66],
           [ 67,  68,  69,  70,  71,  72],
           [ 73,  74,  75,  76,  77,  78],
           [ 79,  80,  81,  82,  83,  84],
           [ 85,  86,  87,  88,  89,  90]],
 
          [[ 91,  92,  93,  94,  95,  96],
           [ 97,  98,  99, 100, 101, 102],
           [103, 104, 105, 106, 107, 108],
           [109, 110, 111, 112, 113, 114],
           [115, 116, 117, 118, 119, 120]]],
 
 
         [[[121, 122, 123, 124, 125, 126],
           [127, 128, 129, 130, 131, 132],
           [133, 134, 135, 136, 137, 138],
           [139, 140, 141, 142, 143, 144],
           [145, 146, 147, 148, 149, 150]],
 
          [[151, 152, 153, 154, 155, 156],
           [157, 158, 159, 160, 161, 162],
           [163, 164, 165, 166, 167, 168],
           [169, 170, 171, 172, 173, 174],
           [175, 176, 177, 178, 179, 180]]]]),
 torch.Size([3, 2, 5, 6]))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a>tens[:,:,<span class="dv">4</span>,:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="164">
<pre><code>tensor([[[ 25,  26,  27,  28,  29,  30],
         [ 55,  56,  57,  58,  59,  60]],

        [[ 85,  86,  87,  88,  89,  90],
         [115, 116, 117, 118, 119, 120]],

        [[145, 146, 147, 148, 149, 150],
         [175, 176, 177, 178, 179, 180]]])</code></pre>
</div>
</div>
<p>Here, the the 5th (index=4) row of each sub tensor with dim <span class="math inline">\(5\)</span>X<span class="math inline">\(6\)</span> is selected.</p>
</section>
<section id="the-data-explorers-motto-visualize-visualize-visualize" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="the-data-explorers-motto-visualize-visualize-visualize"><span class="header-section-number">10.1</span> The data explorerâ€™s motto : <strong>VISUALIZE, VISUALIZE, VISUALIZE</strong></h2>
<section id="pytorch-and-numpy" class="level3" data-number="10.1.1">
<h3 data-number="10.1.1" class="anchored" data-anchor-id="pytorch-and-numpy"><span class="header-section-number">10.1.1</span> PyTorch and NumPy</h3>
<p>PyTorch and NumPy have fucntionality to interact pretty nicely.</p>
<p>To convert NumPy arrays to Pytorch tensors and vice-versa: * <code>torch.from_numpy(ndarray)</code> - NumPy array -&gt; PyTorch tensor. * <code>torch.Tensor.numpy()</code> - PyTorch tensor -&gt; NumPy array.</p>
<p>From an array to a tensor :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true" tabindex="-1"></a>arr<span class="op">=</span>np.arange(<span class="dv">1</span>,<span class="dv">10</span>)</span>
<span id="cb325-3"><a href="#cb325-3" aria-hidden="true" tabindex="-1"></a>tens<span class="op">=</span>torch.from_numpy(arr)</span>
<span id="cb325-4"><a href="#cb325-4" aria-hidden="true" tabindex="-1"></a>arr, tens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="165">
<pre><code>(array([1, 2, 3, 4, 5, 6, 7, 8, 9]), tensor([1, 2, 3, 4, 5, 6, 7, 8, 9]))</code></pre>
</div>
</div>
<p>The default datatype for NumPy is <code>float64</code> so when we convert a NumPy array to a PyTorch tensor it retains the <code>float64</code> datatype. But many PyTorch calculations default to <code>float32</code>.<br>
So to convert a NumPy array(<code>float64</code>) to a PyTorch tensor(<code>float64</code>) to a Pytorch tensor(<code>float32</code>) we do <code>tensor = torch.from_numpy(array).type(torch.float32)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a>arr.dtype, tens.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="166">
<pre><code>(dtype('int64'), torch.int64)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a>tens<span class="op">=</span>torch.from_numpy(arr).<span class="bu">type</span>(torch.float32)</span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a>tens.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="167">
<pre><code>torch.float32</code></pre>
</div>
</div>
<p>From a tensor to an array :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb331"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a>numpy_tens<span class="op">=</span>tens.numpy()</span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true" tabindex="-1"></a>tens,numpy_tens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="168">
<pre><code>(tensor([1., 2., 3., 4., 5., 6., 7., 8., 9.]),
 array([1., 2., 3., 4., 5., 6., 7., 8., 9.], dtype=float32))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb333"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a>tens.dtype, numpy_tens.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="169">
<pre><code>(torch.float32, dtype('float32'))</code></pre>
</div>
</div>
<p><strong>For both tensors and arrays converted from each other when we change any one theres no change in the other</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a>numpy_tens<span class="op">+</span><span class="dv">1</span>,tens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="170">
<pre><code>(array([ 2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10.], dtype=float32),
 tensor([1., 2., 3., 4., 5., 6., 7., 8., 9.]))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb337"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a>numpy_tens<span class="op">+</span><span class="dv">1</span><span class="op">==</span>tens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="171">
<pre><code>False</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb339"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a>arr<span class="op">+</span><span class="dv">1</span>,tens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="172">
<pre><code>(array([ 2,  3,  4,  5,  6,  7,  8,  9, 10]),
 tensor([1., 2., 3., 4., 5., 6., 7., 8., 9.]))</code></pre>
</div>
</div>
<div class="cell" data-tags="[]">
<div class="sourceCode cell-code" id="cb341"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a>arr<span class="op">+</span><span class="dv">1</span><span class="op">==</span>tens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="173">
<pre><code>False</code></pre>
</div>
</div>
</section>
<section id="reproducibility" class="level3" data-number="10.1.2">
<h3 data-number="10.1.2" class="anchored" data-anchor-id="reproducibility"><span class="header-section-number">10.1.2</span> Reproducibility</h3>
<p>To get the same random tensors to make the code reproducable, we use seeds and <code>torch.manual_seed(seed)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(seed<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb343-2"><a href="#cb343-2" aria-hidden="true" tabindex="-1"></a>rand1<span class="op">=</span>torch.rand(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb343-3"><a href="#cb343-3" aria-hidden="true" tabindex="-1"></a>rand3<span class="op">=</span>torch.rand(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)</span>
<span id="cb343-4"><a href="#cb343-4" aria-hidden="true" tabindex="-1"></a>rand1,rand3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="174">
<pre><code>(tensor([[[0.8823, 0.9150, 0.3829, 0.9593],
          [0.3904, 0.6009, 0.2566, 0.7936],
          [0.9408, 0.1332, 0.9346, 0.5936]],
 
         [[0.8694, 0.5677, 0.7411, 0.4294],
          [0.8854, 0.5739, 0.2666, 0.6274],
          [0.2696, 0.4414, 0.2969, 0.8317]]]),
 tensor([[[0.1053, 0.2695, 0.3588, 0.1994, 0.5472],
          [0.0062, 0.9516, 0.0753, 0.8860, 0.5832],
          [0.3376, 0.8090, 0.5779, 0.9040, 0.5547],
          [0.3423, 0.6343, 0.3644, 0.7104, 0.9464]],
 
         [[0.7890, 0.2814, 0.7886, 0.5895, 0.7539],
          [0.1952, 0.0050, 0.3068, 0.1165, 0.9103],
          [0.6440, 0.7071, 0.6581, 0.4913, 0.8913],
          [0.1447, 0.5315, 0.1587, 0.6542, 0.3278]],
 
         [[0.6532, 0.3958, 0.9147, 0.2036, 0.2018],
          [0.2018, 0.9497, 0.6666, 0.9811, 0.0874],
          [0.0041, 0.1088, 0.1637, 0.7025, 0.6790],
          [0.9155, 0.2418, 0.1591, 0.7653, 0.2979]]]))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb345"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(seed<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a>rand2<span class="op">=</span>torch.rand(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb345-3"><a href="#cb345-3" aria-hidden="true" tabindex="-1"></a>rand4<span class="op">=</span>torch.rand(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)</span>
<span id="cb345-4"><a href="#cb345-4" aria-hidden="true" tabindex="-1"></a>rand2,rand4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="175">
<pre><code>(tensor([[[0.8823, 0.9150, 0.3829, 0.9593],
          [0.3904, 0.6009, 0.2566, 0.7936],
          [0.9408, 0.1332, 0.9346, 0.5936]],
 
         [[0.8694, 0.5677, 0.7411, 0.4294],
          [0.8854, 0.5739, 0.2666, 0.6274],
          [0.2696, 0.4414, 0.2969, 0.8317]]]),
 tensor([[[0.1053, 0.2695, 0.3588, 0.1994, 0.5472],
          [0.0062, 0.9516, 0.0753, 0.8860, 0.5832],
          [0.3376, 0.8090, 0.5779, 0.9040, 0.5547],
          [0.3423, 0.6343, 0.3644, 0.7104, 0.9464]],
 
         [[0.7890, 0.2814, 0.7886, 0.5895, 0.7539],
          [0.1952, 0.0050, 0.3068, 0.1165, 0.9103],
          [0.6440, 0.7071, 0.6581, 0.4913, 0.8913],
          [0.1447, 0.5315, 0.1587, 0.6542, 0.3278]],
 
         [[0.6532, 0.3958, 0.9147, 0.2036, 0.2018],
          [0.2018, 0.9497, 0.6666, 0.9811, 0.0874],
          [0.0041, 0.1088, 0.1637, 0.7025, 0.6790],
          [0.9155, 0.2418, 0.1591, 0.7653, 0.2979]]]))</code></pre>
</div>
</div>
<p>We need to reset the seed every time to get the same random tensors each time. Each seed gives the same rand tensors on same number of calls.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(seed<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a>rando<span class="op">=</span>torch.rand(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb347-3"><a href="#cb347-3" aria-hidden="true" tabindex="-1"></a>rando</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="176">
<pre><code>tensor([[[0.7576, 0.2793, 0.4031, 0.7347],
         [0.0293, 0.7999, 0.3971, 0.7544],
         [0.5695, 0.4388, 0.6387, 0.5247]],

        [[0.6826, 0.3051, 0.4635, 0.4550],
         [0.5725, 0.4980, 0.9371, 0.6556],
         [0.3138, 0.1980, 0.4162, 0.2843]]])</code></pre>
</div>
</div>
<p>Changing the seed changes the random tensors or the flavour of the randomness. All randomness in a computer is pseudo-randomness since a computer itself is a deterministic machine but some theories disagree.</p>
</section>
</section>
<section id="gpu" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="gpu"><span class="header-section-number">10.2</span> GPU</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>nvidia<span class="op">-</span>smi</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/bin/bash: line 1: nvidia-smi: command not found</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a>torch.cuda.is_available()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="178">
<pre><code>True</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a>device<span class="op">=</span><span class="st">"cuda"</span> <span class="cf">if</span> torch.cuda.is_available <span class="cf">else</span> <span class="st">"cpu"</span></span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a>device</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="179">
<pre><code>'cuda'</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a>tens<span class="op">=</span>torch.rand(<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a>tens_gpu<span class="op">=</span>tens.to(device)</span>
<span id="cb355-3"><a href="#cb355-3" aria-hidden="true" tabindex="-1"></a>tens_gpu</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>